<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Aviation Graph Screen</title>
<link rel="stylesheet"
	href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
<link rel="stylesheet" href="css/index.css">

<!-- <script -->

<script src="/js/jquery.qtip.min.js"></script>
<script src="/js/menu.js"></script>
<script src="/js/jquery.min.js"></script>
<script	src="/js/bootstrap.min.js"></script>
<script type="text/javascript"	src="http://cdn.jsdelivr.net/momentjs/latest/moment.min.js"></script>
<script type="text/javascript"	src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript" src="http://www.google.com/jsapi"></script>
<script src="http://visjs.org/dist/vis.js"></script>
<link href="http://visjs.org/dist/vis.css" rel="stylesheet"	type="text/css" />
<link href="http://cdnjs.cloudflare.com/ajax/libs/qtip2/3.0.3/jquery.qtip.min.css"	rel="stylesheet" type="text/css" />
<link rel="stylesheet"	href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">

<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
<script src="Utility.js"></script>
<style>
.black_overlay {
	display: none;
	position: absolute;
	top: 0%;
	left: 0%;
	width: 100%;
	height: 100%;
	background-color: black;
	z-index: 1001;
	-moz-opacity: 0.8;
	opacity: .80;
	filter: alpha(opacity = 80);
}

.white_content {
	font-size: 25px;
	display: none;
	position: absolute;
	top: 40%;
	left: 40%;
	width: 20%;
	height: 20%;
	padding: 16px;
	border: 1px solid black;
	background-color: white;
	z-index: 1002;
	overflow: auto;
}

.triangleImage {
	
}

.bgclass {
	background-color: white !important;
}

input#remperbar {
	width: 31px;
	height: 18px;
	margin-top: -10px;
	margin-left: -13px;
}

.vis-item.negative {
	
}

}
.navbar {
	margin-bottom: 0;
	background-color: #01579B;
	border: 0;
	font-size: 11px !important;
	letter-spacing: 4px;
	font-weight: 600;
	position: static;
}

.btndiv {
	display: inline;
	float: left;
	padding-left: 0.5%;
	padding-top: 0.5%;
}
</style>
<style>
body, html {
	font-family: arial, sans-serif;
	font-size: 11pt;
}

.button {
	border: none;
	color: white;
	padding: 12px 24px;
	text-align: center;
	text-decoration: none;
	display: inline-block;
	font-size: 16px;
	margin: 4px 2px;
}

.triangle {
	width: 0px;
	height: 0px;
	border-left: 20px solid transparent;
	border-right: 20px solid transparent;
	border-top: 20px solid #8BC34A;
	margin-left: 7px;
}

.utriangle {
	width: 0px;
	height: 0px;
	border-left: 20px solid transparent;
	border-right: 20px solid transparent;
	border-top: 20px solid Yellow;
}

.ycircle {
	background-color: Yellow;
	border-radius: 50px;
	padding: 12px 12px;
}

.bcircle {
	background-color: Brown;
	border-radius: 50px;
	padding: 12px 12px;
}

.vis-item.negative {
	border-color: white;
	background-color: white;
}

.vis-item {
	background-color: Blue;
}

.vis-item-content {
	padding-top: 0px;
}

.vis-item .vis-item-overflow {
	overflow: visible;
}

.vis-item .vis-item-content {
	padding: 0px;
}

img {
	vertical-align: top;
}
</style>

<!-- <script src="../../Code/vis/dist/vis.js"></script> -->
<!-- <link href="../../Code/vis/dist/vis.css" rel="stylesheet" type="text/css" /> -->
<!-- <script src="../vis/examples/googleAnalytics.js"></script> -->
</head>
<body onload="removal('0')">

	<!-- Top Logo Header -->
	<nav id="home" class="navbar navbar-default navbar-fixed-top">
		<div class="container-fluid">
			<div class="navbar-header">
				<button type="button" class="navbar-toggle" data-toggle="collapse"
					data-target="#myNavbar">
					<span class="icon-bar"></span> <span class="icon-bar"></span> <span
						class="icon-bar"></span>
				</button>
				<a class="navbar-brand" href="index.html">Aviation</a>
			</div>
			<div class="collapse navbar-collapse" id="myNavbar">
				<ul class="nav navbar-nav navbar-right">
					<li><a href="afterLogin.html">HOME</a></li>

					<li class="dropdown"><a class="dropdown-toggle"
						data-toggle="dropdown" href="#">Menu <span class="caret"></span>
					</a>
						<ul class="dropdown-menu">

							<li><a href="Unit_Filter.html">Filter Editor</a></li>
							<li><a href="Splash_Screen.html">Component Analysis</a></li>
						</ul></li>

					<li><a href="index.html" id="logout">LOGOUT</a></li>
				</ul>
			</div>
		</div>
	</nav>
	<!-- End of Top Logo Header -->

	<form action="">
		<br />
		<br />
		<br />
		<div class="main_content bgclass">
			<div style='text-align: center'>
				<!-- div for button alignment -->
				<div class="btndiv">
					<!-- <button class="filebtn list-cust-btn">File</button> -->
					<!-- <button class="statbtn list-cust-btn">Statistics</button> -->
					<input type="button" onclick="printDiv('visualization')"
						value="File" class="filebtn list-clear-btn"> <input
						type="button" value="Statistics" class="statbtn list-clear-btn">
				</div>

				<label class="right_label">Component Removal History</label>
			</div>
		</div>
		<div class="main_left">

			<div class="left_p1">
				<!-- <div class="checkbox filter-checkbox form-group filter_left2_p2"> 
				 <label id="tab-caption" style="border-bottom: 1px solid;width: 100%;border-bottom-color: black;">Sort</label> 
				<input type="string" style="width: 70px;" id="sort" value="Sort">
			<table class="tab_change">
				
				<tr>
					<td><label><input type="checkbox"
							name="Yearly">Yearly</label></td>
				</tr>

				<tr>
				<td><label><input type="checkbox" name="Monthly">Monthly</label></td>
				</tr>
				<tr>
				<td><label><input type="checkbox" name="Weekly">Weekly</label></td>
			   </tr>
				</table>
			</div> -->
				<hr id="date_line">
				<div class="form-group date-range ">
					<!-- <center><label for="dateRange" class="label_date" style="color: brown;">Extract Date</label></center> -->
					<div class="date_range_select ">
						<label for="fromDate" class="label_date">Extract Date</label> <input
							type="text" class="form-control" style="margin-bottom: 4px;"
							id="currentDate" readonly="true" /> <label for="dateRange"
							class="label_date">Date Range</label> <input type="text"
							class="form-control" style="margin-bottom: 4px;" id="dateRange"
							readonly="true" />
					</div>

				</div>

				<hr id="analysisByLine">
				<div>
					<div class="checkbox filter-checkbox form-group filter_left2_p2">
						<label id="tab-caption"
							style="border-bottom: 1px solid; width: 33%; border-bottom-color: black; padding-left: 2%;">Analysis
							By</label>
					</div>
					<table style="margin-left: 10px;">
						<tr>
							<td><input type="radio" name="filter" id="bestFirst"
								onchange="onChangeRadioButton()" /></td>
							<td><label>Best First</label></td>
						</tr>
						<tr>
							<td><input type="radio" name="filter" id="worstFirst"
								onchange="onChangeRadioButton()" checked /></td>
							<td><label>Worst First</label></td>
						</tr>
					</table>
				</div>


				<hr id="installationPeriodLine">
				<div>
					<div class="checkbox filter-checkbox form-group filter_left2_p2">
						<table>
							<tr>
								<td style="padding-left: 8px; padding-top: 3px;"><input
									type="checkbox" name="instperbar" id="instperbar"
									checked="true" disabled="disabled" hidden="true" /></td>

								<td><label id="tab-caption"
									style="border-bottom: 1px solid; width: 100%; border-bottom-color: black; padding-left: 4px !important; padding-bottom: 0px !important;">Installation
										Period Bar</label></td>
							</tr>
						</table>
					</div>
					<table style="margin-left: 10px;">
						<tr>
							<td><label>Installed</label></td>
							<td><div class="button" style="background-color: Blue;" /></td>
						</tr>
						<tr>
							<td><label>Removed</label></td>

							<td><div class="button" style="background-color: white;"></td>
						</tr>
					</table>
				</div>


				<hr id="removalPeriodLine">
				<div>

					<div class="checkbox filter-checkbox form-group filter_left2_p2">
						<table>
							<tr>
								<td style="padding-left: 8px; padding-top: 3px;"><input
									type="checkbox" name="remperbar" id="remperbar" checked="true" /></td>

								<td><label id="tab-caption"
									style="border-bottom: 1px solid; width: 100%; border-bottom-color: black; padding-left: 4px !important; padding-bottom: 0px !important;">Removal
										Event</label></td>

								<td style="padding-left: 16px;"><p
										class="glyphicon glyphicon-triangle-bottom"
										style="font-size: 30px; color: red;"></p></td>
							</tr>
						</table>
					</div>
					<table style="margin-left: 10px;">
						<tr>
							<td><label>Scheduled</label></td>
							<td><div class="triangle"></div></td>
						</tr>
						<tr>
							<td><label>Unscheduled</label></td>

							<td style="padding-left: 6px"><div class="utriangle"></div></td>
						</tr>
						<tr>
							<td><label>Others</label></td>

							<td style="padding-left: 6px"><div class="bcircle button"></div></td>
						</tr>
					</table>

				</div>

				<hr id="removalPeriodLine">
				<div style="padding-bottom: 10px;">
					<input
						style="padding-bottom: 0; margin-left: 30px; word-wrap: break-word; width: 160px; height: 50px;"
						name="action" type="button" value="Component Analysis"
						onclick="splashScreen()" />
				</div>
				<div style="padding-bottom: 10px;">
					<input
						style="padding-bottom: 0; margin-left: 30px; word-wrap: break-word; width: 160px; height: 50px;"
						name="action" type="button" value="Filter Editor"
						onclick="component();" />
				</div>

			</div>
		</div>
	</form>


	<br />
	<!-- <br/><br/><br/><br/><br/><br/><br/><br/> -->

	<div id="visualization"></div>


	<div class="col-sm-12" style="margin-top: 12px;">

		<div class="row">
			<div class="col-sm-3"></div>
			<div class="col-sm-2" style="padding-bottom: 10px;">
				<input type="button" class="btn btn-primary" value="<< Previous"
					id="previous" onclick="onPageLoad('-1')">
			</div>
			<div class="col-sm-5"></div>
			<div class="col-sm-2" style="padding-bottom: 10px;">
				<!-- <input type="button" class="form-control" class="btn btn-primary"  value="Next >>"  id="next" onclick="pagination('1')"> -->
				<input type="button" class="btn btn-primary" value="Next >>"
					id="next" onclick="onPageLoad('1')">
			</div>
		</div>
	</div>
	<script>
  $( function() {
	    $(document).tooltip({
	    	track: true,
	    	content: function () {
	              return $(this).prop('title');
	          }
	      });
  } );
  </script>
	<script type="text/javascript">

var step;
var currentcount;
var forStart;
var forEnd;
var worstFitGroupList=[];
var worstFitItemList=[];
var worstFitGroupListFinal=[]
var statusValue=[];
var worstFitItemListFinal=[]
function component(){
	
	window.location="Unit_Filter.html";
	
}
function splashScreen(){
window.location="Splash_Screen.html";
}
// Instantiate our timeline object.
function printDiv(divName) {
     var printContents = document.getElementById(divName).innerHTML;
     var originalContents = document.body.innerHTML;

     document.body.innerHTML = printContents;

     window.print();

     document.body.innerHTML = originalContents;
}
var report={};

var removal=function(step1){
	////alert("report call")
	$.ajax({
		url : "/removalReport/"+step1,
		async: false,
        cache: false,
		success : function(data) { 
			report=data;
			step=0;
			forStart=0;
			forEnd=0;
			currentcount=0;

			
			onPageLoad(step)	
		}
	
		
	});
	
}

function onChangeRadioButton(){
	document.getElementById('visualization').innerHTML = "";
  	  
     onPageLoad('0');
  
	}

function onPageLoad(value){
step=value;
var temp=0;

  document.getElementById("visualization").innerHTML = "";
	 
  paginationStatus();
  
  $('input[name="instperbar"],input[name="remperbar"]').unbind().click(function(){
		if($(this).attr('checked')){
		//console.log('block1');
		$(this).attr('checked',false);
		}
		else{
		$(this).attr('checked','checked');
		//console.log('block2');
		}
		
});
 
 
$('input[name="instperbar"]').click(function(){
	var sample=document.getElementById("instperbar");
	//alert("checked status"+sample);
	filterlogic();
		
		//alert("checked status"+sample);
		
console.log('filter applied');
})

$('input[name="remperbar"]').click(function(){
		
    	//alert("checked status"+document.getElementById("remperbar"));
		filterlogic();
		
       console.log('filter applied');
})
  
	<!-- ***************Start of Filter logic for chart selection***************	 -->
	function filterlogic(){

		 if($('input[name="instperbar"]').attr('checked') == 'checked' && ($('input[name="remperbar"]').attr('checked') == false || $('input[name="remperbar"]').attr('checked') == undefined)){
			 $('.triangleImage').css('display','none');
			$('.vis-item-overflow,.vis-range,.vis-item.vis-background.positive').css('display','block');
				console.log('show bars');
			} 
		  if(($('input[name="instperbar"]').attr('checked')== false || $('input[name="instperbar"]').attr('checked') == undefined) && $('input[name="remperbar"]').attr('checked')== 'checked'){
			
				$('.vis-item-overflow,.vis-range,.vis-item.vis-background.positive').css('display','none');
				//$('.vis-item.vis-background.grph_bcircle,.vis-item.vis-background.grph_ycircle,.vis-item.vis-background.negative,.triangleImage').css('display','block');
				 $('.triangleImage').css('display','block');
				console.log('show triangle');
			}
		 if($('input[name="instperbar"]').attr('checked')== 'checked' && $('input[name="remperbar"]').attr('checked')=='checked'){	
			 //$('.vis-item-overflow,.vis-range,.vis-item.vis-background.positive').css('display','block');
			$('.vis-item-overflow,.vis-range,.vis-item.vis-background.positive').css('display','block');	
			 $('.triangleImage').css('display','block');
							console.log('show all');
		}
		
		if(($('input[name="instperbar"]').attr('checked')== false || $('input[name="instperbar"]').attr('checked') == undefined) && ($('input[name="remperbar"]').attr('checked') == false || $('input[name="remperbar"]').attr('checked') == undefined)){
				$('.vis-item-overflow,.vis-range,.vis-item.vis-background.grph_bcircle,.vis-item.vis-background.negative,.vis-item.vis-background.positive,.vis-item.vis-background.grph_ycircle,.triangleImage').css('display','none');
				console.log('show none');
		}  
	}
	<!-- ***************End of Filter logic for chart selection***************	 -->
  
  
  // Create a DataSet (allows two way data-binding)
   var items = new vis.DataSet({
        type: { start: 'Moment', end: 'Moment' }
    }); 
   var groups = new vis.DataSet();
  
   var length=report.groupList.length;
   if(forEnd==length){
		forEnd=forStart;
		forStart=forStart-25;
		currentcount=currentcount-1;
	}else if(step==1){
		forStart=forStart+25;
		forEnd=forEnd+25;
		currentcount=currentcount+1;
	}else if(step==-1){
		forStart=forStart-25;
		forEnd=forEnd-25;
		currentcount=currentcount-1;
	}else if(step==0){
		forStart=0;
		forEnd=25;
		currentcount=1;
	}
   
	if(forEnd>length){
		forEnd=length;
	}
   
   if(step==0){
	   worstFitGroupListFinal=[]

	  worstFitItemListFinal=[]
	   worstFitGroupList=[];
	   worstFitItemList=[];
   for(var i=0; i<report.groupList.length; i++){
	   
	   bestCount=0
	   worstCount= report.groupList.length
   			for(j=0 ; j<report.itemList.length; j++){ 
   				
	     			if(report.groupList[i].id ==report.itemList[j].group){ 
	     				if(report.itemList[j].content!=""){
	     					       bestCount++
	     					       worstCount--
	     					   }
	     				}
	   		}
	    groups1={}  
	    groups1["id"]=report.groupList[i].id;
	    groups1["bestCount"]=bestCount;
	    groups1["worstCount"]=worstCount;
	    groups1["content"]=report.groupList[i].content;
	    worstFitGroupList.push(groups1);
	    	if(temp<bestCount){
	    		temp=bestCount;
	    	}
	   }

   for(var i=0; i< worstFitGroupList.length; i++){
   			for(j=0 ; j<report.itemList.length; j++){ 
   				
	     			if(worstFitGroupList[i].id ==report.itemList[j].group){ 
	     				   
	     				items1={}
	     				items1["id"]=report.itemList[j].id
	     				items1["content"]=report.itemList[j].content
	     				items1["start"]=report.itemList[j].start
	     				items1["end"]= report.itemList[j].end
	     				items1["group"]= report.itemList[j].group
	     				items1["className"]= report.itemList[j].className
	     				items1["type"]= report.itemList[j].type
	     				items1["title"]= report.itemList[j].title
	     				worstFitItemList.push(items1)
	     			}
   			}
 } 
	     		
      worstFit= document.getElementById("worstFirst").checked;
      bestFit= document.getElementById("bestFirst").checked;
  
 
  if(worstFit) { 
 for(var k=temp;k>=0; k--){
	   
	   for(var i=0; i<worstFitGroupList.length; i++){
			if(worstFitGroupList[i].bestCount == k){
	    worstFitGroupListFinal.push(worstFitGroupList[i]);
			}
	   }
 }
  }

 if(bestFit) {
	 for(var k=0;k<=temp; k++){
		   
		   for(var i=0; i<worstFitGroupList.length; i++){
				if(worstFitGroupList[i].bestCount == k){
		    worstFitGroupListFinal.push(worstFitGroupList[i]);
				}
		   }
	 }
	   
 }
 
   worstFitItemListFinal=worstFitItemList;
   
   
   }

worstFitGroupListFinal1=[]
worstFitItemListFinal1=[]
   
 for(var i=forStart; i<forEnd; i++){
   			for(j=0 ; j<worstFitItemListFinal.length; j++){ 
	     			if(worstFitGroupListFinal[i].id ==worstFitItemListFinal[j].group){ 
	     				items1={}
	     				items1["id"]=worstFitItemListFinal[j].id
	     				items1["content"]=worstFitItemListFinal[j].content
	     				items1["start"]=worstFitItemListFinal[j].start
	     				items1["end"]= worstFitItemListFinal[j].end
	     				items1["group"]= worstFitItemListFinal[j].group
	     				items1["className"]= worstFitItemListFinal[j].className
	     				items1["type"]= worstFitItemListFinal[j].type
	     				items1["title"]= worstFitItemListFinal[j].title
	     				worstFitItemListFinal1.push(items1)
	     				}
	   		} 
	  
	    worstFitGroupListFinal1.push(worstFitGroupListFinal[i]);
	   }
	    groups.add(worstFitGroupListFinal1)  
	    items.add(worstFitItemListFinal1) 

var endDate=statusValue[2];
	    var startDate=statusValue[3];
    alert("end date "+endDate+" start date "+startDate)
    var container = document.getElementById('visualization');
    var options= {
	      
    	     dataAttributes: 'all',
  	       zoomable: false,
  	    	clickToUse: false,
  	    	selectable: false,
  	        editable: false,
  	        stack: false,
  	        showCurrentTime: false,
  	      end:startDate,
  	      end:endDate,
  	        orientation:{
  	        	
  	        	axis:'both'
  	        }
	    };
	
 
    	worstFit= document.getElementById("worstFirst").checked;
   	    bestFit= document.getElementById("bestFirst").checked;
   	 
    	if(worstFit)
    		{ 		
    		options["groupOrder"]="worstCount";
    		}
    	
    	if(bestFit){
    		options["groupOrder"]="bestCount";
    	}
    
    var timeline = new vis.Timeline(container, items, groups, options); 
      	paginationStatus();

}


function pagination(value) {
	document.getElementById('visualization').innerHTML = "";

     var items = new vis.DataSet({
          type: { start: 'Moment', end: 'Moment' }
      }); 
     var groups = new vis.DataSet();
     
   
     groups.add(report.groupList);
     items.add(report.itemList);


      var container = document.getElementById('visualization');
      var options = {
    
         zoomable: false,
      	   clickToUse: true,
          editable: false,
          stack: false
      };

      var timeline = new vis.Timeline(container, items, groups, options);
      
      function onClick (event) {
      	  var properties = timeline.getEventProperties(event);
      	  if(properties.item){
      		  for (i = 0; i < report.itemList.length; i++) { 
  			    if(properties.item == report.itemList[i].id){
  			    	if(report.itemList[i].className == 'negative'){
  			    		document.getElementById('light').style.display='block';document.getElementById('fade').style.display='block';
  			    	}
  			    }
  			  }
      		  
      	  }
      	  
      	}
      	container.addEventListener('click', onClick) ;
      	paginationStatus();
}


var paginationStatus=function(){

	$.ajax({
		url : "/paginationStatus",
		async: false,
        cache: false,
		success : function(data) { 
			status=data;
				
					statusValue=[];
					var nextStatus;
					var previousStatus;
					statusValue =status.split(',');
					loadvalue.push(statusValue);
					 var actual=report.groupList.length;
					 var actualLength=Math.ceil(actual/25);
					 //alert("actual length"+actualLength)
					if(currentcount == actualLength){
						document.getElementById("next").disabled=true;
						document.getElementById("previous").disabled=false;
						
					}else if(currentcount==1){
						document.getElementById("next").disabled=false;
						document.getElementById("previous").disabled=true;
					}else{
						document.getElementById("next").disabled=false;
						document.getElementById("previous").disabled=false;
					}
					
					document.getElementById("dateRange").value = statusValue[0]+" - "+statusValue[1];
					
					var today = new Date();
					var dd = today.getDate();
					var mm = today.getMonth()+1; //January is 0!

					var yyyy = today.getFullYear();
					if(dd<10){
					    dd='0'+dd
					} 
					if(mm<10){
					    mm='0'+mm
					} 
					var fromDate = dd+'/'+mm+'/'+yyyy;
					document.getElementById("currentDate").value = fromDate;
										
		}
	
		
	});
	
}

</script>


	<div id="light" class="white_content">
		Removal Data: <a style="text-align: right;" href="javascript:void(0)"
			onclick="document.getElementById('light').style.display='none';document.getElementById('fade').style.display='none'">Close</a>
		<br />Date: 2014-11-21 <br />Removal Reason: 02

	</div>
	<div id="fade" class="black_overlay"></div>
</body>
</html>